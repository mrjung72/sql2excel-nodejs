@echo off
chcp 65001 > nul
color 0F

echo.
echo β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
echo β•‘                   XML μ„¤μ •νμΌ ν…μ¤νΈ                            β•‘
echo β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
echo.

echo μƒν” XML μ„¤μ •νμΌμ„ μ‚¬μ©ν• μ—‘μ…€ νμΌ μƒμ„±μ„ μ‹μ‘ν•©λ‹λ‹¤...
echo.

:: output λ””λ ‰ν† λ¦¬ μƒμ„±
if not exist "output" mkdir output

echo π“ XML μ¤νƒ€μΌ ν…μ¤νΈ μ¤‘...
echo.
echo ν¬ν•¨λλ” μ‹νΈ:
echo   β“ μ£Όλ¬Έ_λ©λ΅ (ν—¤λ”: μ¤‘μ•™μ •λ ¬/νλ€λ°°κ²½/κ²€μ€ν…λ‘λ¦¬)
echo   β“ κ³ κ°_λ©λ΅ (λ°”λ””: μΆμΈ΅μ •λ ¬/λ…Έλ€λ°°κ²½/νμƒ‰ν…λ‘λ¦¬)
echo   β“ λ©μ°¨ μ‹νΈ
echo.
echo ν…μ¤νΈ λ‚΄μ©:
echo   β–¶ Alignment (μ •λ ¬): ν—¤λ” center, λ°”λ”” left
echo   β–¶ Border (ν…λ‘λ¦¬): ν—¤λ” κ²€μ€μƒ‰, λ°”λ”” νμƒ‰
echo   β–¶ Font (ν°νΈ): λ§‘μ€ κ³ λ”•, ν—¤λ” 12px κµµκ², λ°”λ”” 11px μΌλ°
echo   β–¶ Fill (λ°°κ²½): ν—¤λ” νλ€μƒ‰, λ°”λ”” λ…Έλ€μƒ‰
echo.

:: XML νμΌμ„ μ‚¬μ©ν• μ—‘μ…€ νμΌ μƒμ„± μ‹¤ν–‰
node src/index.js -x resources/queries-sample.xml

if %errorlevel% equ 0 (
    echo.
    echo β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
    echo β•‘                        μƒμ„± μ™„λ£!                               β•‘
    echo β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
    echo.
    echo π“ μƒμ„±λ νμΌ:
    echo    - λ§¤μ¶μ§‘κ³„_2024_yyyymmddhhmmss.xlsx
    echo    - λ§¤μ¶μ§‘κ³„_2024_λ©μ°¨_yyyymmddhhmmss.xlsx
    echo.
    echo π“‹ XML vs JSON λΉ„κµ ν™•μΈ:
    echo    β–¶ JSON νμΌ: test-sample-orders.bat μ‹¤ν–‰
    echo    β–¶ XML νμΌ: λ°©κΈ μƒμ„±λ νμΌ
    echo    β–¶ λ™μΌν• μ¤νƒ€μΌμ΄ μ μ©λμ—λ”μ§€ ν™•μΈν•΄μ£Όμ„Έμ”!
    echo.
    echo π¨ μ¤νƒ€μΌ ν™•μΈ μ‚¬ν•­:
    echo    β“ ν—¤λ” μ…€: μ¤‘μ•™μ •λ ¬, νλ€λ°°κ²½, ν°κΈ€μ, κ²€μ€ν…λ‘λ¦¬
    echo    β“ λ°μ΄ν„° μ…€: μΆμΈ΅μ •λ ¬, λ…Έλ€λ°°κ²½, κ²€μ€κΈ€μ, νμƒ‰ν…λ‘λ¦¬
    echo    β“ μ»¬λΌ λ„λΉ„: μλ™ μ΅°μ • (μµμ† 10, μµλ€ 30)
    echo.
    echo output ν΄λ”λ¥Ό μ—΄κΉμ”? (Y/N)
    set /p open_folder=
    if /i "%open_folder%"=="Y" (
        explorer "output"
    )
) else (
    echo.
    echo β μ—‘μ…€ νμΌ μƒμ„±μ— μ‹¤ν¨ν–μµλ‹λ‹¤.
    echo.
    echo κ°€λ¥ν• μ›μΈ:
    echo   1. λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ‹¤ν¨
    echo   2. SampleDB λ°μ΄ν„°λ² μ΄μ¤κ°€ μ΅΄μ¬ν•μ§€ μ•μ
    echo   3. XML νμ‹± μ¤λ¥
    echo.
    echo ν•΄κ²° λ°©λ²•:
    echo   1. SQL Server Management Studioμ—μ„ λ‹¤μ μ¤ν¬λ¦½νΈλ¥Ό μμ„λ€λ΅ μ‹¤ν–‰:
    echo      - resources/create_sample_tables.sql
    echo      - resources/insert_sample_data.sql
    echo   2. resources/config.jsonμ—μ„ DB μ—°κ²°μ •λ³΄ ν™•μΈ
    echo   3. resources/queries-sample.xml νμΌ κµ¬λ¬Έ ν™•μΈ
    echo.
)

echo.
echo π’΅ XMLκ³Ό JSON μ¤νƒ€μΌ μ°¨μ΄ λΉ„κµ ν…μ¤νΈ:
echo    1. test-sample-xml.bat (XML νμΌ)
echo    2. test-sample-orders.bat (JSON νμΌ)
echo    λ‘ νμΌμ„ μ‹¤ν–‰ν•μ—¬ μ¤νƒ€μΌμ΄ λ™μΌν•κ² μ μ©λλ”μ§€ ν™•μΈν•μ„Έμ”!
echo.
pause 