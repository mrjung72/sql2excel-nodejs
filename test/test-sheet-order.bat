@echo off
chcp 65001 > nul
color 0F

echo.
echo β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
echo β•‘                    μ‹νΈ μμ„ ν™•μΈ ν…μ¤νΈ                          β•‘
echo β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
echo.

echo λ©μ°¨ μ‹νΈκ°€ λ§¨ μ™Όμ½μ— μ„μΉν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
echo.

:: output λ””λ ‰ν† λ¦¬ μƒμ„±
if not exist "output" mkdir output

echo π“ μ‹νΈ μμ„ ν…μ¤νΈμ© μ—‘μ…€ μƒμ„± μ¤‘...
echo.

:: XML νμΌλ΅ ν…μ¤νΈ
node src/index.js -x resources/queries-sample.xml

if %errorlevel% equ 0 (
    echo.
    echo β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
    echo β•‘                      μ‹νΈ μμ„ ν…μ¤νΈ μ™„λ£!                        β•‘
    echo β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
    echo.
    echo π“ μƒμ„±λ νμΌμ—μ„ μ‹νΈ μμ„λ¥Ό ν™•μΈν•μ„Έμ”:
    echo.
    echo π“‹ μμƒ μ‹νΈ μμ„:
    echo    1. λ©μ°¨          (νλ€μƒ‰ νƒ­, λ§¨ μ™Όμ½)
    echo    2. μ£Όλ¬Έ_λ©λ΅     (λ‘ λ²μ§Έ)
    echo    3. κ³ κ°_λ©λ΅     (μ„Έ λ²μ§Έ)  
    echo    4. μ£Όλ¬Έ_μƒμ„Έ     (λ„¤ λ²μ§Έ)
    echo.
    echo π” ν™•μΈ λ°©λ²•:
    echo.
    echo 1. μƒμ„±λ Excel νμΌμ„ Microsoft Excelμ—μ„ μ—΄κΈ°
    echo 2. ν™”λ©΄ ν•λ‹¨μ μ‹νΈ νƒ­ μμ„ ν™•μΈ
    echo 3. 'λ©μ°¨' νƒ­μ΄ λ§¨ μ™Όμ½μ— μκ³  νλ€μƒ‰μΈμ§€ ν™•μΈ
    echo 4. λ©μ°¨ μ‹νΈλ¥Ό ν΄λ¦­ν•΄μ„ λ‚΄μ© ν™•μΈ
    echo.
    echo π“ μ‹νΈ νƒ­ νΉμ§•:
    echo    β“ λ©μ°¨ μ‹νΈ: νλ€μƒ‰ νƒ­μΌλ΅ κµ¬λ¶„
    echo    β“ λ°μ΄ν„° μ‹νΈ: κΈ°λ³Έ μƒ‰μƒ
    echo    β“ μμ„: λ©μ°¨ β†’ λ°μ΄ν„° μ‹νΈλ“¤ (μ•νλ²³/ν•κΈ€ μ)
    echo.
    echo π”§ κΈ°μ μ  κµ¬ν„:
    echo    - workbook.worksheets λ°°μ—΄ μ¬μ •λ ¬
    echo    - κ° μ‹νΈμ id λ° orderNo μ¬μ„¤μ •
    echo    - μ‹νΈ νƒ­ μƒ‰μƒμΌλ΅ λ©μ°¨ κµ¬λ¶„
    echo.
    echo π’΅ λ¬Έμ  ν•΄κ²°:
    echo.
    echo λ§μ•½ λ©μ°¨κ°€ λ§¨ μ™Όμ½μ— μ—†λ‹¤λ©΄:
    echo    1. Excelμ„ μ™„μ „ν λ‹«κ³  λ‹¤μ‹ μ—΄κΈ°
    echo    2. νμΌμ„ λ‹¤λ¥Έ μ΄λ¦„μΌλ΅ μ €μ¥ ν›„ λ‹¤μ‹ μ—΄κΈ°
    echo    3. Excel μΊμ‹ λ¬Έμ μΌ μ μμ
    echo.

    echo output ν΄λ”λ¥Ό μ—΄κΉμ”? (Y/N)
    set /p open_folder=
    if /i "%open_folder%"=="Y" (
        explorer "output"
    )
) else (
    echo.
    echo β μ—‘μ…€ νμΌ μƒμ„±μ— μ‹¤ν¨ν–μµλ‹λ‹¤.
    echo    λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°μ„ ν™•μΈν•μ„Έμ”.
    echo.
)

echo.
echo π”„ λ‹¤λ¥Έ ν…μ¤νΈ:
echo    - test-toc-links.bat     : λ©μ°¨ λ§ν¬ κΈ°λ¥ ν…μ¤νΈ
echo    - test-sample-orders.bat : λ€μ©λ‰ μ‹νΈ μμ„ ν…μ¤νΈ
echo.
pause 